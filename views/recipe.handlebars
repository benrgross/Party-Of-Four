<nav style="background-color: #f0fbff" class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a href="/members"><img src="/images/logo.png" alt="Pipe Cleaner Logo"></img></a>

    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
</nav>
<div class="columns">
  <div class="column is-one-quarter">
    <h4 class="title is-4 menu-title">What would you like to do?</h4>
    <aside class="menu">
      <ul class="menu-list">
        <li><a class="is-active" href="/members">Home</a></li>
        <p class="menu-label">Meals</p>
        <li><a href="/meals">Input Your Meals</a></li>
        <li><a href="/past-meals">Past Meals</a></li>
      </ul>
      <p class="menu-label">
        Watchlist
      </p>
      <ul class="menu-list">
        <ul>
          <a>Healthy Choices</a>
          <li><a href="/recipe">Nutrition Info</a></li>
          <li><a href="/watchlist">Foods to Watchout for</a></li>
        </ul>
    </aside>
  </div>

  <section class="column is-three-quarters">
    <h1 class="title is-1">Welcome <span class="title member-name"></span></h1>

    <h1 style="margin-bottom: 100px;">Welcome <span class="member-name"></span></h1>
    {{!-- <div class="field">
      <label class="label">Meal time: </label>
      <div class="control">
        <input type="time">
      </div>
    </div> --}}
    <div class="field">

      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css">

      <div id="home">

        <div class="container">



          </li>
          </ul>
        </div>
      </div>
      </nav>

      <div class="container">
        <div class="row">
          <div class="col-8 offset-2">
            <form class="needs-validation" novalidate>
              <!-- Name -->
              <div class="form-group mb-3 mt-3">
                <label for="name">Meal Name</label>
                <input type="text" class="form-control" id="name" placeholder="" value="" required>
                <div class="invalid-feedback">
                  Valid name is required.
                </div>
              </div>

              <!-- Description -->
              <div class="form-group mb-3">
                <label for="recipe-description">Meal Description
                  <span class="text-muted">(Optional)</span>
                </label>
                <textarea class="form-control" id="recipe-description" aria-describedby="recipe-description"
                  placeholder="Enter Recipe Description"></textarea>
              </div>

              <!-- Input ingredients -->

              <div class="container">

                <div class="form-group mb-5">

                  <label for="autocomplete">Search Ingredient</label>
                  <div class="input-group">
                    <input name="q" type="text" class="form-control" id="autocomplete"
                      placeholder="Search ingredients to add" autofocus>

                    <div class="input-group-append">
                      <span class="input-group-text">
                        <i class="fas fa-search"></i>
                      </span>

                    </div>
                  </div>
                </div>

                <!-- Table ingredients -->
                <table class="table table-hover">
                  <tbody id="list_ingredients">

                  </tbody>
                </table>

                <!-- Submit Button -->
                <button type="submit" id="submit" class="btn btn-primary float-right"> Add
                  Ingredient</button>
                </li>


            </form>
            <div></div>
            <a class="btn btn-primary float-right" href="/recipe">Nutrition Info</a>


          </div>
        </div>

      </div>
    </div>

    <div class="modal" tabindex="-1" role="dialog" id="myModal">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title text-danger">Error!</h5>
          </div>
          <div class="modal-body">
            <p class="text-danger">Please add the ingredients first.</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
      integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
      crossorigin="anonymous"></script>
    <script src="/js/recipe.js"></script>
    {{!--
    <script src="~bulma-calendar/dist/js/bulma-calendar.min.js"></script>
    <script>
      // Initialize all input of date type.
      const calendars = bulmaCalendar.attach('[type="date"]', options);

      // Loop on each calendar initialized
      calendars.forEach(calendar => {
        // Add listener to select event
        calendar.on('select', date => {
          console.log(date);
        });
      });

      // To access to bulmaCalendar instance of an element
      const element = document.querySelector('#my-element');
      if (element) {
        // bulmaCalendar instance is available as element.bulmaCalendar
        element.bulmaCalendar.on('select', datepicker => {
          console.log(datepicker.data.value());
        });
      }

    </script> --}}

</div>
</div>
</div>
</div>


</div>

<div id="home">

  <div class="collapse navbar-collapse" id="navbarResponsive">
    <ul class="navbar-nav ml-auto">
      <li class="nav-item active">
        <a class="nav-link" href="/recipe">New Ingredient
          <span class="sr-only">(current)</span>
        </a>

    </ul>
  </div>
</div>
</nav>



<hr>
<!-- LIST OF RECIPES -->
<h4 style="color:blue; text-align: center;">Ingredient and Nutrition List</h4>
<h4 style="color:blue; text-align: center;"></h4>
<hr>

<div class="table-responsive">
  <table class="table table-hover" id="table_ingredients">
    <thead>
      <tr>
        <th>Ingredient Name</th>
        <th>Meal Description</th>
      </tr>
    </thead>
    <tbody>
      {{#each recipes}}
      <tr>
        <td>
          <a href="recipe/{{this.recipeId}}">{{this.recipeName}}</a>
        </td>
        <td>
          <a href="recipe/{{this.recipeId}}">{{this.recipeDescription}}</a>
        </td>
      </tr>
      {{/each}}
    </tbody>
  </table>
</div>
</div>
</div>
<div class="container">
  <form action="https://www.google.com/search" method="get" target="_blank" id="search-form">
    <input name="q" type="text" placeholder="Search Google..." autocomplete="off" autofocus>
    <!-- <button type="button"><i class="fas fa-microphone"></i></button> -->
  </form>
  <p class="info"></p>
</div>

<script>
  const searchForm = document.querySelector("#search-form");
  const searchFormInput = searchForm.querySelector("input"); // <=> document.querySelector("#search-form input");
  const info = document.querySelector(".info");

  // The speech recognition interface lives on the browserâ€™s window object
  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition; // if none exists -> undefined

  if (SpeechRecognition) {
    console.log("Your Browser supports speech Recognition");

    const recognition = new SpeechRecognition();
    recognition.continuous = true;
    // recognition.lang = "en-US";

    searchForm.insertAdjacentHTML("beforeend", '<button type="button"><i class="fas fa-microphone"></i></button>');
    searchFormInput.style.paddingRight = "50px";

    const micBtn = searchForm.querySelector("button");
    const micIcon = micBtn.firstElementChild;

    micBtn.addEventListener("click", micBtnClick);
    function micBtnClick() {
      if (micIcon.classList.contains("fa-microphone")) { // Start Voice Recognition
        recognition.start(); // First time you have to allow access to mic!
      }
      else {
        recognition.stop();
      }
    }

    recognition.addEventListener("start", startSpeechRecognition); // <=> recognition.onstart = function() {...}
    function startSpeechRecognition() {
      micIcon.classList.remove("fa-microphone");
      micIcon.classList.add("fa-microphone-slash");
      searchFormInput.focus();
      console.log("Voice activated, SPEAK");
    }

    recognition.addEventListener("end", endSpeechRecognition); // <=> recognition.onend = function() {...}
    function endSpeechRecognition() {
      micIcon.classList.remove("fa-microphone-slash");
      micIcon.classList.add("fa-microphone");
      searchFormInput.focus();
      console.log("Speech recognition service disconnected");
    }

    recognition.addEventListener("result", resultOfSpeechRecognition); // <=> recognition.onresult = function(event) {...} - Fires when you stop talking
    function resultOfSpeechRecognition(event) {
      const current = event.resultIndex;
      const transcript = event.results[current][0].transcript;

      if (transcript.toLowerCase().trim() === "stop recording") {
        recognition.stop();
      }
      else if (!searchFormInput.value) {
        searchFormInput.value = transcript;
      }
      else {
        if (transcript.toLowerCase().trim() === "go") {
          searchForm.submit();
        }
        else if (transcript.toLowerCase().trim() === "reset input") {
          searchFormInput.value = "";
        }
        else {
          searchFormInput.value = transcript;
        }
      }
      // searchFormInput.value = transcript;
      // searchFormInput.focus();
      // setTimeout(() => {
      //   searchForm.submit();
      // }, 500);
    }

    info.textContent = 'Voice Commands: "stop recording", "reset input", "go"';

  }
  else {
    console.log("Your Browser does not support speech Recognition");
    info.textContent = "Your Browser does not support Speech Recognition";
  }
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/1.10.18/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/1.10.18/js/dataTables.bootstrap4.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
  integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<script src="js/index.js"></script>

<script src="/js/recipe_details.js"></script>

{{!--
<script type="text/javascript" src="js/members.js"></script> --}}


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css">



<scrip type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></scrip>
<scrip src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.js"></scrip>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
  integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<script src="/js/recipe.js"></script>